<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Agenda Builder</title>
  <link rel="icon" href="../../../IMG/JD_Web_Solutions.ico">
  
  <link rel="stylesheet" href="../../../CSS/main.css" />
  <link rel="stylesheet" href="../../../CSS/components-menu.css" />
  <link rel="stylesheet" href="../../../CSS/components-sidemenu.css" />
  <link rel="stylesheet" href="./agendabuilder.css" />
  <script>
    // Thema script mag blijven staan
    (function () {
      try {
        var pref = localStorage.getItem('theme_pref') || 'system';
        var final = pref === 'system'
          ? (window.matchMedia && matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
          : pref;
        document.documentElement.setAttribute('data-theme', final);
      } catch (e) { /* no-op */ }
    })();
  </script>

    <script>window.APP_ENV = "DEV";</script>
</head>

<body class="module-agendabuilder">
  
  <div data-include="../../../partials/header.html"></div>

  <div id="app" style="display:none;">
      <div class="page">
          
          <div class="main-grid">
            
            <section class="card left-panel">
                <h2 style="margin-bottom:20px;">Agenda Builder</h2>

                <h3 class="section-label">1. Kies Agenda</h3>
                <div id="container-calendars" class="chips">
                    <span class="tiny muted">Laden...</span>
                </div>
                <input id="calendarId" type="hidden" />

                <h3 class="section-label">2. Label & Titel</h3>
                <div class="selection-area">
                    <label>Labels</label>
                    <div id="container-labels" class="chips"></div>
                    
                    <label style="margin-top:8px;">Titels</label>
                    <div id="container-titles" class="chips"></div>
                </div>

                <div class="row" style="margin-top:12px;">
                    <div><label>Label</label><input id="label" placeholder="Optioneel" /></div>
                    <div><label>Titel</label><input id="title" placeholder="Verplicht" /></div>
                </div>

                <h3 class="section-label">3. Tijdstip</h3>
                <div class="row">
                    <div><label>Datum</label><input id="date" type="date" /></div>
                    <div><label>Tijdzone</label><input id="tz" readonly style="opacity:0.6" /></div>
                </div>
                <div class="row">
                    <div><label>Start</label><input id="start" type="time" /></div>
                    <div><label>Einde</label><input id="end" type="time" /></div>
                </div>
                <div class="row">
                    <div><label>Of Duur (u)</label><input id="durH" type="number" min="0" placeholder="0" /></div>
                    <div><label>Min (m)</label><input id="durM" type="number" min="0" step="5" placeholder="0" /></div>
                </div>

                <h3 class="section-label">4. Details</h3>
                <label>Locaties</label>
                <div id="container-locations" class="chips"></div>
                
                <div class="row" style="margin-top:8px;">
                    <div><label>Locatie</label><input id="location" placeholder="..." /></div>
                    <div><label>Beschrijving</label><input id="description" placeholder="..." /></div>
                </div>

                <div class="btns" style="margin-top:20px; display:flex; gap:10px;">
                    <button id="btnTogglePayload" class="ghost small">üëÅÔ∏è Debug</button>
                    <button id="btnSend" class="primary big" style="background:#22c55e; border-color:#22c55e; flex:1;">
                        üöÄ Verstuur POST
                    </button>
                </div>

                <div id="payloadArea" class="payload-area">
                    <label>JSON</label><div id="resultJson" class="out">...</div>
                    <label>Link</label><div id="resultUrl" class="out">...</div>
                </div>
            </section>

            <aside class="right-panel">
                <div class="side-actions">
                    <button id="btnConfig" class="primary full-width" style="margin-bottom:10px;">‚öôÔ∏è Configuratie</button>
                    <button id="btnReset" class="ghost full-width">üîÑ Reset Formulier</button>
                </div>

                <div class="card" style="margin-top:20px;">
                    <h2 style="font-size:1rem;">‚ö° Snelkoppelingen</h2>
                    <div id="container-shortcuts" class="shortcut-list">
                        <span class="tiny muted">Geen snelkoppelingen.</span>
                    </div>
                </div>
            </aside>

          </div>
      </div>
  </div>

  <div id="modal-config" class="modal-card" hidden style="max-width:900px;">
    <div class="modal-header"><h3>Instellingen</h3><button class="modal-close" data-modal-close="modal-config">‚úï</button></div>
    <div class="modal-body">
        
        <div class="config-section">
            <h4>üîë API & Webhook</h4>
            <div class="row">
                <div>
                    <label>Webhook URL</label>
                    <div class="input-group">
                        <input id="cfg-webhook" type="password" />
                        <button class="toggle-pw" onclick="togglePw('cfg-webhook')">üëÅÔ∏è</button>
                    </div>
                </div>
                <div>
                    <label>Token</label>
                    <div class="input-group">
                        <input id="cfg-token" type="password" />
                        <button class="toggle-pw" onclick="togglePw('cfg-token')">üëÅÔ∏è</button>
                    </div>
                </div>
            </div>
            <button id="btnSaveApi" class="primary small">Opslaan</button>
        </div>

        <div class="config-section">
            <h4>üìÖ Agenda's</h4>
            <div id="list-calendars" class="config-list"></div>
            <div class="row" style="margin-top:8px;">
                <input id="new-cal-name" placeholder="Naam" />
                <input id="new-cal-color" type="color" value="#3b82f6" class="color-swatch" />
                <button id="btnAddCal" class="btn small primary">Toevoegen</button>
            </div>
        </div>

        <div class="config-section">
            <h4>üè∑Ô∏è Labels</h4>
            <div id="list-labels" class="config-list"></div>
            <div class="row" style="margin-top:8px;">
                <input id="new-label-name" placeholder="Nieuw Label" />
                <button id="btnAddLabel" class="btn small primary">Toevoegen</button>
            </div>
        </div>

        <div class="config-section">
            <h4>üìù Titels</h4>
            <div id="list-titles" class="config-list"></div>
            <div class="row" style="margin-top:8px;">
                <input id="new-title-name" placeholder="Nieuwe Titel" />
                <button id="btnAddTitle" class="btn small primary">Toevoegen</button>
            </div>
        </div>

        <div class="config-section">
            <h4>üìç Locaties</h4>
            <div id="list-locations" class="config-list"></div>
            <div class="row" style="margin-top:8px;">
                <input id="new-location-name" placeholder="Nieuwe Locatie" />
                <button id="btnAddLocation" class="btn small primary">Toevoegen</button>
            </div>
        </div>

        <div class="config-section" style="border:none;">
            <h4>‚ö° Snelkoppelingen Beheer</h4>
            <div id="list-shortcuts" class="config-list"></div>
            
            <div class="form-grid" style="background:rgba(0,0,0,0.03); padding:10px; border-radius:8px; margin-top:15px;">
                <h5>Nieuwe maken</h5>
                <label>Naam knop</label>
                <input id="sc-name" placeholder="bv. Fitness Ochtend" />
                
                <div class="row" style="margin-top:8px;">
                    <div><label>Agenda</label><select id="sc-cal"><option value="">- Kies -</option></select></div>
                    <div><label>Label</label><select id="sc-label"><option value="">- Kies -</option></select></div>
                </div>
                
                <label>Titel</label>
                <select id="sc-title"><option value="">- Kies -</option></select>
                <button id="btnAddShortcut" class="primary small" style="margin-top:10px;">Opslaan</button>
            </div>
        </div>

    </div>
    <div class="modal-footer"><button class="ghost" data-modal-close="modal-config">Sluiten</button></div>
  </div>

  <div data-include="../../../partials/modals.html"></div>
  <script src="../../../script/javascript/include-partials.js"></script>
  <script type="module" src="../../../script/javascript/modal.js"></script>
  <script type="module" src="../../../src/components/navigation.js"></script>
  <script type="module" src="./agendabuilder.js"></script>
  
  <script>
      function togglePw(id) {
          const el = document.getElementById(id);
          el.type = el.type === 'password' ? 'text' : 'password';
      }
  </script>
</body>
</html>